# Simple Makefile for Invoicing SaaS - Basic Commands
# Use this if Docker Compose V2 issues persist

.PHONY: help dev-simple build test clean install-deps

# Default target
help:
	@echo "🚀 Invoicing SaaS - Simple Commands"
	@echo ""
	@echo "Basic Commands:"
	@echo "  make dev-simple   Start development without Docker"
	@echo "  make build        Build the Go application"
	@echo "  make test         Run tests"
	@echo "  make clean        Clean build artifacts"
	@echo "  make install-deps Check dependencies"

# Start development (local Go, requires PostgreSQL)
dev-simple:
	@echo "🐹 Starting development (local Go)..."
	@echo "⚠️  Make sure PostgreSQL is running on localhost:5432"
	@echo "💡 Run: createdb invoicing (if database doesn't exist)"
	@cd invoicing-backend && go run cmd/server/main.go

# Build the application
build:
	@echo "🔨 Building Go application..."
	@cd invoicing-backend && go build -o bin/server cmd/server/main.go
	@echo "✅ Build complete: invoicing-backend/bin/server"

# Run tests
test:
	@echo "🧪 Running tests..."
	@cd invoicing-backend && go test ./...

# Clean build artifacts
clean:
	@echo "🧹 Cleaning build artifacts..."
	@rm -rf invoicing-backend/bin/
	@echo "✅ Clean complete"

# Install dependencies
install-deps:
	@echo "📦 Checking dependencies..."
	@which go || (echo "❌ Go is required but not installed" && exit 1)
	@which docker || (echo "⚠️  Docker not found - Docker commands won't work" || true)
	@docker compose version || (echo "⚠️  Docker Compose V2 not found - use Makefile.simple" || true)
	@echo "✅ Dependencies check complete"
